extends layout

block scripts

block content
  :coffeescript
    $(document).ready () ->
      parabola = """
        var shift = 0;
        while (shift <= 200) {
          two.makeLine(shift, 0, 200, shift);
          shift += 14;
        }
      """

      boilerplate = (drawCode) -> """
        two.clear();
        #{drawCode}
        two.update();
      """

      two = new Two({ width: 200, height: 200 })
        .appendTo(document.getElementById('targetcanvas'));

      delay = null
      editor = CodeMirror $("#editor")[0], {
        value: parabola
        mode:  "javascript"
        viewportMargin: Infinity
        tabMode: "spaces"
        }
      editor.on "change", () ->
        clearTimeout(delay)
        delay = setTimeout(updatePreview, 300)

      editor.on "cursorActivity", () ->

      updatePreview = () ->
        drawCode = boilerplate(editor.getValue())
        `eval(drawCode)`

      setTimeout(updatePreview, 300)


  div(class="row")
    div(class="large-12 large-centered columns")
      div(class="row")
        div(class="large-10 columns")
          h1#title
            = title 

        div(class="large-2 columns top-buttons")
          .run

    div(class="large-12 large-centered columns")
      div(class="row")
        div(class="large-6 columns")
          #editor

        div(class="large-6 columns canvas")
          #targetcanvas


